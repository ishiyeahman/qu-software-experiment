                         4 .list
                         5 /* *_count の値を変更して繰り返し変え数を決定する */
                         6 .section .data
                         7 	.equ	IN_COUNT, 128
                         8 	.equ	OUT_COUNT, 129
                         9 	.equ	queue_number, 0
                        10 
                        11 .section .text
                        12 
                        13 ** 0x1000からデータを適当に入力する
                        14 ** 0x1300にとりだされたデータが格納される
                        15 ** 0x1600に戻り値1 or 0が格納される
                        16 
                        17 start:
                        18 	
000400 227C 0000        19 	move.l	#0x1000, %A1
       1000             19 
000406 247C 0000        20 	move.l	#0x1300, %A2
       1300             20 
00040c 267C 0000        21 	move.l	#0x1600, %A3
       1600             21 
                        22 	
                        23 finish:
000412 4E72 0A8C        24 	stop	#2700
                        25 
                        26 
                        27 /* =============================== */
                        28 in_set:
000416 2638 0080        29 	move.l	IN_COUNT, %d3
                        30 
                        31 in_loop:
00041a 2038 0000        32 	move.l	queue_number, %d0
                        33 	
                        34 	/* 書き込むべきデータを与える */
00041e 1218             35 	move.b	(%A0)+, %D1
                        36 
                        37 	**jsr	INQ
                        38 	/* 戻り値の格納 */
000420 22C0             39 	move.l	%D0, (%A1)+
                        40 
000422 5383             41 	subq.l	#1, %d3
000424 6600 FFF4        42 	bne	in_loop
000428 6000 0002        43 	bra	out_set
                        44 
                        45 /* ================================ */
                        46 	
                        47 
                        48 out_set:
00042c 2638 0081        49 	move.l	OUT_COUNT, %d3
                        50 
                        51 out_loop:
000430 2038 0000        52 	move.l	queue_number, %d0
                        53 	** jsr OUTQ
                        54 
                        55 	/* データと戻り値をメモリに格納しておく*/
000434 14C1             56 	move.b	%D1, (%A2)+
000436 26C0             57 	move.l	%D0, (%A3)+
                        58 
000438 5383             59 	subq.l	#1, %d3
00043a 6600 FFF4        60 	bne out_loop
00043e 6000 FFD2        61 	bra finish	
                        62 
                        63 
                        64 /* キュー領域の前後での書き込みが発生していないことを確認する*/
                        65 
                        66 
                        67 /* 以下に　INQ と OUTQ を貼り付ける*/
                        68 
                        69 
                        70 
                        71 
